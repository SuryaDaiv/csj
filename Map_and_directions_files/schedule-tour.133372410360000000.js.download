ysi.initScheduleTour=function(){ysi.urlPattern||(document.querySelector('input[name="contactUsUrlPattern"]')?ysi.urlPattern=document.querySelector('input[name="contactUsUrlPattern"]').value:ysi.urlPattern=document.querySelector('input[name="scheduleTourUlPattern"]').value),ysi.scheduleTourData=JSON.parse(document.getElementById("schedule-tour-data").innerHTML),ysi.RCPropertyId=document.querySelector('input[name="RCPropertyId"]').value,ysi.IsforCorpProperty=document.querySelector('input[name="IsforCorpProperty"]').value;let e=document.getElementById("TourModal");var t=[],n=[];if(""!==ysi.scheduleTourData.rescheduleSGTUnits&&(t=ysi.scheduleTourData.rescheduleSGTUnits.split(","),document.getElementById("SGTUnits").value=t.toString()),document.getElementById("IsCancelAppt")||(l(),m(null)),ysi.datepicker.init(document.getElementById("txtDesiredMoveinDate"),{minDate:new Date}),document.getElementById("noofbed")&&document.getElementById("noofbed").classList.remove("d-none"),ysi.recaptcha){var o=!0;document.getElementById("UseNewCaptcha")&&"False"===document.getElementById("UseNewCaptcha").value&&(o=!1),ysi.recaptcha&&o&&ysi.recaptcha.initEnt(),ysi.scrollObserver.isSupported()?ysi.scrollObserver.init(document.querySelector("#scheduletourcaptcha"),{transit:"in",offset:"500px",once:!0,callback:function(){ysi.recaptcha.init("scheduletourcaptcha")}}):ysi.recaptcha.init("scheduletourcaptcha"),ysi.scrollObserver.isSupported()?ysi.scrollObserver.init(document.querySelector("#recaptcha"),{transit:"in",offset:"500px",once:!0,callback:function(){ysi.recaptcha.init("recaptcha")}}):ysi.recaptcha.init("recaptcha")}function r(){var e=function(e){document.getElementById("txtApptTime").value=e.innerText.trim(),e.querySelector("input")&&e.querySelector("input").focus(),t.forEach(function(e){}),document.querySelector(".timeconfirmbtn").classList.remove("d-none"),document.getElementById("isScheduleFromLink")?document.getElementById("divcaptcha").classList.remove("d-none"):document.querySelector(".timeconfirmbtn").innerHTML="Confirm "+document.querySelector(".dateselected").innerHTML+" at "+e.innerText},t=document.querySelectorAll(".availableslots_button");t.forEach(function(t){t.addEventListener("click",function(){e(t)}),t.addEventListener("keydown",function(e){9===e.keyCode&&(e.shiftKey?document.querySelector(".flatpickr-button").focus():document.querySelector(".timeconfirmbtn").focus(),e.preventDefault(),e.stopPropagation())}),t.addEventListener("keyup",function(n){32===n.keyCode&&e(t)})}),t.length>0&&t[0].click()}function l(e){ysi.datepicker.init(document.getElementById("scheduledate"),{minDate:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()+parseInt(document.getElementById("apptstartday").value)),maxDate:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate()+parseInt(document.getElementById("apptendday").value)),onChange:function(e,t,n){m(e)},disabled:[function(e){if("0"===document.getElementById("tourType").value||"2"===document.getElementById("tourType").value)var t=ysi.scheduleTourData.validDateArray;else t=ysi.scheduleTourData.validDateArraySGT;if(void 0===t||null===t)return!1;let n=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"/"+(e.getDate()<10?"0"+e.getDate():e.getDate())+"/"+e.getFullYear();for(let e of t)if(n==e)return!0;return!1}]});var o=document.querySelectorAll(".calendar-btn");o.forEach(function(e){e.addEventListener("click",function(){e.querySelector('input[type="radio"]')&&e.querySelector('input[type="radio"]').focus();var l=e.querySelector(".datewithformat").value,a=new Date(l);a.setDate(a.getDate()+1),ysi.datepicker.set(document.getElementById("txtDesiredMoveinDate"),"minDate",a),document.getElementById("txtApptDate").value=l,document.querySelector(".timeconfirmbtn").classList.add("d-none"),document.getElementById("divcaptcha")&&document.getElementById("divcaptcha").classList.add("d-none"),document.querySelector(".availabletimeslabel").classList.add("d-none");const c=document.getElementById("availableslots");c.innerHTML=ysi.utils.translateText("Processing Request..."),o.forEach(function(e){}),req=new XMLHttpRequest,req.onreadystatechange=function(){if(4===req.readyState&&200===req.status){c.innerHTML=req.responseText,document.querySelector(".dateselected").innerHTML=document.getElementById("selectedslotdate").value,document.querySelector(".availabletimeslabel").classList.remove("d-none"),r();var e=document.querySelectorAll(".radio-time");e&&e.length>0&&e[0].click()}};var d=document.getElementById("tourType").value;"0"!==d&&"2"!==d||(d="0",t=[],n=[]);var i="dtSchedule="+l+"&tourType="+d+"&txtBedroom="+document.getElementById("txtBedroom").value+"&units="+t.toString();"1"===ysi.IsforCorpProperty&&ysi.RCPropertyId>0&&(i+="&IsforCorpProperty="+ysi.IsforCorpProperty+"&RCPropertyId="+ysi.RCPropertyId),req.open("POST",ysi.urlPattern+"/scheduletour?handler=GetAvailableSlots"),req.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),req.setRequestHeader("RequestVerificationToken",document.getElementById("scheduletour-request-verification-token").value),req.setRequestHeader("Cache-Control","no-cache, no-store, max-age=0"),req.setRequestHeader("Expires","Tue, 01 Jan 1980 1:00:00 GMT"),req.setRequestHeader("Pragma","no-cache"),req.send(i)})}),e&&document.querySelector('.selecteddate[value="'+e+'"]').click()}BSN.initCallback();var a=document.querySelector(".changedatetime");function c(e){if(document.querySelector(".custom-breadcrumb")){e=parseInt(e);var t=document.getElementById("tourType").value;3===e&&("1"!==t||"1"===t&&ysi.scheduleTourData.useSGTBedSelect)?previoustab=document.querySelector(".breadcrumb-item-"+(e-2)):previoustab=document.querySelector(".breadcrumb-item-"+(e-1)),1===e?document.querySelector(".breadcrumb-item-2").classList.add("d-none"):2===e&&document.querySelector(".breadcrumb-item-2").classList.remove("d-none"),previoustab&&previoustab.classList.remove("active"),nexttab=document.querySelector(".breadcrumb-item-"+(e+1)),nexttab&&nexttab.classList.remove("active"),currenttab=document.querySelector(".breadcrumb-item-"+e),currenttab.classList.add("active");var n=document.createElement("a");n.href="javascript:void(0)",n.innerHTML=currenttab.innerText,currenttab.innerHTML="",currenttab.appendChild(n)}else{e=parseInt(e),t=document.getElementById("tourType").value;var o=document.querySelector(".schedule-tour-back-btn");o&&(1===e||document.location.pathname.includes("default")&&3===e?o.classList.add("d-none"):o.classList.remove("d-none"),2===e||3===e&&"1"!==t?(o.dataset.destination="select",o.dataset.step=1):3===e?(o.dataset.destination="floorplan",o.dataset.step=2):4===e&&(o.dataset.destination="calendar",o.dataset.step=3))}}a&&a.addEventListener("click",function(){document.querySelector(".breadcrumb-item-3")&&(document.querySelector(".breadcrumb-item-3").innerHTML=document.querySelector(".breadcrumb-item-3").innerText),c(3),y("calendar")});var d=document.getElementById("btncancel");function i(){d.disabled=!0,d.innerHTML="<i class='fas fa-spinner fa-spin'></i> "+ysi.utils.translateText("Processing Request...");var e=document.getElementById("recaptcha-block"),t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&200===t.status&&t.responseText.length>0){if("captchaentfailed"===t.responseText)return document.getElementById("scheduletour-grecaptcha-terms").classList.add("d-none"),e.classList.remove("d-none"),e.classList.add("is-invalid"),event.preventDefault(),event.stopPropagation(),d.disabled=!1,d.innerHTML="Cancel My Appointment",document.getElementById("failed-captcha-ent").value="true",!1;window.location=t.responseText}};var n="dtApptScheduled="+document.getElementById("dtApptScheduled").value+"&VoyProspectId="+document.getElementById("VoyProspectId").value+"&ApptId="+document.getElementById("ApptId").value+"&g-recaptcha-response-ent="+document.getElementById("g-recaptcha-response-ent").value+"&failed-captcha-ent="+document.getElementById("failed-captcha-ent").value;null!==document.getElementById("txtPrefixType")&&(n+="&txtPrefixType="+document.getElementById("txtPrefixType").value),document.getElementById("g-recaptcha-response")&&(n=n+"&g-recaptcha-response="+document.getElementById("g-recaptcha-response").value),t.open("POST",ysi.urlPattern+"/scheduletour?handler=CancelAppointment"),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.setRequestHeader("RequestVerificationToken",document.getElementById("request-verification-token").value),t.send(n)}d&&d.addEventListener("click",function(){var e=!0;document.getElementById("UseNewCaptcha")&&"False"===document.getElementById("UseNewCaptcha").value&&(e=!1);var t=document.getElementById("hide_captcha");if(t&&0===t.value&&void 0!==grecaptcha&&0===grecaptcha.getResponse().length)return alert("Please verify you are not a robot."),event.preventDefault(),event.stopPropagation(),document.getElementsByTagName("iframe").focus(),!1;var n=document.getElementById("recaptcha-block");e&&n?(ysi.recaptcha.resetEnt(),grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(ysi.recaptcha.EntSitekey,{action:"CancelTour"}).then(function(e){for(var t=document.getElementsByName("g-recaptcha-response-ent"),n=0;n<t.length;n++)t[n].value=e;i()})})):i()});var s=document.getElementById("confirm-appointment-btn");function u(){s.disabled=!0,s.innerHTML="<i class='fas fa-spinner fa-spin'></i> "+ysi.utils.translateText("Processing Request...");var e=document.getElementById("tourType").value,n=!1;n="0"===e?document.getElementById("enableidv-gt").value:"1"===e?document.getElementById("enableidv").value:document.getElementById("enableidv-lvt").value;var o,r="";""!==ysi.scheduleTourData.preselectedFloorplan&&(r="&floorplan="+ysi.scheduleTourData.preselectedFloorplan),document.getElementById("txtBedroom")&&(o="&txtBedroom="+document.getElementById("txtBedroom").value);var l="";""!==ysi.scheduleTourData.preselectedSqft&&(l="&sqft="+ysi.scheduleTourData.preselectedSqft);""!==ysi.scheduleTourData.preselectedRentMin&&(l="&rentmin="+ysi.scheduleTourData.preselectedRentMin);""!==ysi.scheduleTourData.preselectedRentMax&&(l="&rentmax="+ysi.scheduleTourData.preselectedRentMax);var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState&&200===a.status&&a.responseText.length>0){if("captchaentfailed"===a.responseText){var e=document.getElementById("recaptcha-block");return document.getElementById("scheduletour-grecaptcha-terms").classList.add("d-none"),e.classList.remove("d-none"),e.classList.add("is-invalid"),event.preventDefault(),event.stopPropagation(),s.disabled=!1,s.innerHTML="Confirm Appointment",document.getElementById("failed-captcha-ent").value="true",!1}window.location=a.responseText}};var c="txtApptDate="+document.getElementById("txtApptDate").value+"&txtApptTime="+document.getElementById("txtApptTime").value+"&VoyProspectId="+document.getElementById("VoyProspectId").value+"&ApptId="+document.getElementById("ApptId").value+"&action="+document.getElementById("txtaction").value+"&dtApptScheduled="+document.getElementById("dtApptScheduled").value+"&Tourtype="+e+"&isScheduleFromLink="+document.getElementById("isScheduleFromLink").value+o+r+l+"&IdVerification="+n+"&units="+t.toString()+"&g-recaptcha-response-ent="+document.getElementById("g-recaptcha-response-ent").value+"&failed-captcha-ent="+document.getElementById("failed-captcha-ent").value;null!==document.getElementById("txtPrefixType")&&(c+="&txtPrefixType="+document.getElementById("txtPrefixType").value),document.getElementById("g-recaptcha-response")&&(c=c+"&g-recaptcha-response="+document.getElementById("g-recaptcha-response").value),a.open("POST",ysi.urlPattern+"/scheduletour?handler=ScheduleAppointment"),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.setRequestHeader("RequestVerificationToken",document.getElementById("request-verification-token").value),a.send(c)}function m(e){var t=new XMLHttpRequest,n="";if(e){var o=(e=new Date(e)).getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear();n="selectedDate="+o}n="0"==document.getElementById("tourType").value||"2"==document.getElementById("tourType").value?n+"&nadays="+ysi.scheduleTourData.validDateArray:n+"&nadays="+ysi.scheduleTourData.validDateArraySGT,t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&200===t.status&&t.responseText.length>0&&(document.getElementById("weeklycalendar-maindiv").innerHTML=t.responseText,void 0!==o&&o?l(o):l())};var r=ysi.urlPattern+"/scheduletour?handler=GetWeeklyCalendar";ysi.scheduleTourIsDialog&&(r+="&isDialog=true"),t.open("POST",r),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.setRequestHeader("RequestVerificationToken",document.getElementById("calendar-request-verification-token").value),t.setRequestHeader("Cache-Control","no-cache, no-store, max-age=0"),t.setRequestHeader("Expires","Tue, 01 Jan 1980 1:00:00 GMT"),t.setRequestHeader("Pragma","no-cache"),t.send(n)}function y(e){var t="schedule-tour-"+e,n=document.querySelectorAll(".schedule-tour-section"),o=document.getElementById(t);n.forEach(function(e){e.classList.remove("schedule-tour-section-active")}),o.classList.add("schedule-tour-section-active"),function(){document.querySelector(".btnconfirmbed")&&document.querySelector(".btnconfirmbed").classList.add("d-none"),document.querySelector("bedselectdiv")&&document.querySelector("bedselectdiv").classList.add("d-none");var e=document.querySelectorAll(".tour-option"),t=document.querySelectorAll(".bedselect");e.forEach(function(e){tourType}),t.forEach(function(e){})}(),"calendar"===e&&document.querySelector('.custom-date-radiogroup input[type="radio"]').focus();let r=o.closest(".popup-widgets-window");r&&ysi.modal&&ysi.modal.setTrap(r)}s&&s.addEventListener("click",function(){var e=document.getElementById("hide_captcha"),t=document.getElementById("recaptcha-block"),n=!0;if(document.getElementById("UseNewCaptcha")&&"False"===document.getElementById("UseNewCaptcha").value&&(n=!1),e&&"False"===e.value&&t&&!t.classList.contains("d-none")&&void 0!==grecaptcha&&0===grecaptcha.getResponse().length)return alert("Please verify you are not a robot."),event.preventDefault(),event.stopPropagation(),document.getElementsByTagName("iframe").focus(),!1;n&&t?(ysi.recaptcha.resetEnt(),grecaptcha.enterprise.ready(function(){grecaptcha.enterprise.execute(ysi.recaptcha.EntSitekey,{action:"ScheduleTour"}).then(function(e){for(var t=document.getElementsByName("g-recaptcha-response-ent"),n=0;n<t.length;n++)t[n].value=e;u()})})):u()}),document.querySelectorAll('input[name="bedsSelection"]').forEach(function(e){e.addEventListener("click",function(){e.checked&&function(e){if(document.querySelectorAll(".floorplan-container").forEach(function(t){e<0?t.classList.remove("d-none"):t.classList.add("d-none")}),e>-1){var t=document.querySelectorAll('[data-floorplan-bed="'+e+'"]');t.forEach(function(e){e.classList.remove("d-none")})}}(parseInt(e.dataset.value))})});var p=document.getElementById("flooorplan-dropdown-btn"),v=document.getElementById("floorplan-dropdown-list");e&&e.addEventListener("click",function(e){(e.target.closest("#flooorplan-dropdown-btn")||e.target.closest("#floorplan-dropdown-list"))&&(p.hasAttribute("data-active")?(p.removeAttribute("data-active",!0),p.setAttribute("aria-expanded",!0),v.classList.add("active-fp-list")):(p.setAttribute("data-active",!1),p.setAttribute("aria-expanded",!1),v.classList.remove("active-fp-list")))}),function(){var o;!function(){var e=document.querySelectorAll(".breadcrumb-item");e.forEach(function(t){t.addEventListener("click",function(){if(!t.classList.contains("active")&&t.getElementsByTagName("a").length>0){let a=["tab1","tab2","tab3","tab4"];for(var n of a){let e=0;for(var o=0,r=t.classList.length;o<r;++o){var l=new RegExp(n+".*");if(l.test(t.classList[o])){e=1;break}}1===e&&("tab3"===n&&(t.nextElementSibling.innerHTML=t.nextElementSibling.innerText,c(3),y("calendar")),"tab2"===n&&(t.nextElementSibling.innerHTML=t.nextElementSibling.innerText,null!==t.nextElementSibling.nextElementSibling&&(t.nextElementSibling.nextElementSibling.innerHTML=t.nextElementSibling.nextElementSibling.innerText),c(2),ysi.scheduleTourData.useSGTBedSelect?y("select"):y("floorplan")),"tab1"===n&&(t.nextElementSibling.innerHTML=t.nextElementSibling.innerText,t.nextElementSibling.nextElementSibling.innerHTML=t.nextElementSibling.nextElementSibling.innerText,null!==t.nextElementSibling.nextElementSibling.nextElementSibling&&(t.nextElementSibling.nextElementSibling.nextElementSibling.innerHTML=t.nextElementSibling.nextElementSibling.nextElementSibling.innerText),c(1),y("select")))}e.forEach(function(e){e===t?e.classList.add("active"):e.classList.remove("active")})}})});var t=document.querySelector(".schedule-tour-back-btn");t&&t.addEventListener("click",function(){t.dataset.destination&&y(t.dataset.destination),t.dataset.step&&c(parseInt(t.dataset.step))})}(),(o=document.querySelectorAll(".tour-option")).forEach(function(e){e.addEventListener("click",function(){o.forEach(e=>{var t=e.querySelector(".stretched-link"),n=t.getAttribute("aria-label");n="Select "+(n=n.replace(" selected","").replace("Select ","")),t.setAttribute("aria-label",n)});var t=e.querySelector(".stretched-link").getAttribute("aria-label");if(t=t.replace("Select ",""),t+=" selected",e.querySelector(".stretched-link").setAttribute("aria-label",t),e.classList.contains("sgt"))if(document.getElementById("tourType").value="1",l(),m(null),ysi.scheduleTourData.useSGTBedSelect){document.getElementById("bedselectdiv")&&(document.getElementById("bedselectdiv").classList.remove("d-none"),document.getElementById("bedselectdiv").scrollIntoView({behavior:"smooth",block:"center",inline:"center"}));let t=document.getElementById("sgt-bedroom-options");t&&t.classList.remove("d-none");let n=document.getElementById("sgt-bed-not-available");n&&n.classList.remove("d-none");let o=document.getElementById("gt-bedroom-options");o&&o.classList.add("d-none");let r=document.querySelector(".sgt-bedselect");r&&r.click(),document.querySelectorAll(".tour-option").forEach(e=>e.classList.remove("bg-primary","text-white")),document.querySelectorAll(".card-appt-length").forEach(e=>e.classList.add("text-dark")),document.querySelectorAll(".card-text").forEach(e=>e.classList.add("text-mute")),e.classList.add("bg-primary","text-white"),e.querySelector(".card-appt-length").classList.remove("text-dark"),e.querySelector(".card-text").classList.remove("text-muted")}else c(2),y("floorplan");else{document.getElementById("bedselectdiv")&&document.getElementById("bedselectdiv").classList.remove("d-none");let t=document.getElementById("sgt-bedroom-options");t&&t.classList.add("d-none");let n=document.getElementById("sgt-bed-not-available");n&&n.classList.add("d-none");let o=document.getElementById("gt-bedroom-options");o&&!o.classList.contains("d-none")?(o.classList.add("fadeOut"),setTimeout(()=>{o.classList.remove("fadeOut")},250)):o.classList.remove("d-none"),document.querySelectorAll(".tour-option").forEach(e=>e.classList.remove("bg-primary","text-white")),document.querySelectorAll(".card-appt-length").forEach(e=>e.classList.add("text-dark")),document.querySelectorAll(".card-text").forEach(e=>e.classList.add("text-mute")),e.classList.add("bg-primary","text-white"),e.querySelector(".card-appt-length").classList.remove("text-dark"),e.querySelector(".card-text").classList.remove("text-muted"),e.classList.contains("lvt")?document.getElementById("tourType").value="2":document.getElementById("tourType").value="0",document.querySelector(".gt-bedselect").click(),l(),m(null)}})}),function(){for(var e=document.querySelectorAll(".unit-list .radio-unit"),o=document.getElementsByClassName("show-unit"),r=function(){this.classList.add("d-none"),this.classList.remove("d-block"),this.parentElement.querySelector(".unit-list").classList.remove("d-none"),this.parentElement.querySelector(".unit-list").classList.add("d-block"),this.parentElement.querySelector(".radio-unit").click(),this.parentElement.querySelector(".radio-unit").focus()},l=0;l<o.length;l++)o[l].addEventListener("click",r,!1);for(var a=document.getElementsByClassName("hide-unit"),d=function(){this.closest(".unit-list-block").querySelector(".show-unit").classList.add("d-block"),this.closest(".unit-list-block").querySelector(".show-unit").focus(),this.closest(".unit-list").classList.remove("d-block"),this.closest(".unit-list").classList.add("d-none");for(var e=this.closest(".unit-list").querySelectorAll(".radio-unit"),n=0;n<e.length;n++){e[n].checked=!1,e[n].parentNode.classList.remove("selected-units");const o=t.indexOf(e[n].value);g(o)}var o=document.querySelectorAll(".selected-units");document.getElementById("selected-unit-count").innerHTML=o.length,0===o.length&&document.getElementById("btn-deselect").classList.add("d-none"),f()},l=0;l<a.length;l++)a[l].addEventListener("click",d,!1);for(var i=0,s=0;s<e.length;s++)e[s].addEventListener("click",u);function u(e){document.getElementById("btn-continue-scheduling").classList.remove("d-none");for(var o=e.target,r=o.closest(".custom-time-radiogroup").querySelectorAll(".unit-list .radio-unit"),l=0;l<r.length;l++){r[l].parentNode.classList.remove("selected-units");const e=t.indexOf(r[l].value);g(e)}o.parentNode.classList.add("selected-units"),i=document.querySelectorAll(".selected-units"),document.getElementById("selected-unit-count").innerHTML=i.length,document.getElementById("btn-deselect").classList.remove("d-none"),t.push(o.value),n.push(o.dataset.unitnum)}var m=document.getElementById("btn-deselect"),p=document.querySelectorAll(".unit-list .radio-unit");m&&m.addEventListener("click",function(e){for(var o=0;o<p.length;o++)p[o].checked=!1,p[o].parentNode.classList.remove("selected-units"),document.getElementById("selected-unit-count").innerHTML="0";t=[],n=[],f();var r=document.getElementsByClassName("hide-unit");Array.prototype.forEach.call(r,e=>{e.click()}),this.classList.add("d-none")});var v=document.getElementById("btn-continue-scheduling");function g(e){e>-1&&(t.splice(e,1),n.splice(e,1))}function f(){0===t.length&&document.getElementById("btn-continue-scheduling").classList.add("d-none")}v&&v.addEventListener("click",function(){t.length>0&&(document.getElementById("SGTUnits").value=t.toString(),c(3),y("calendar"))})}(),function(){var e=document.querySelectorAll(".gt-beds-button"),t=document.querySelectorAll(".sgt-beds-button"),n=function(e){document.getElementById("txtBedroom").value=e.querySelector("input").value,e.querySelector("input").focus(),document.querySelector(".btnconfirmbed").classList.remove("d-none")};e.forEach(function(e){e.addEventListener("click",function(){n(e)}),e.addEventListener("keydown",function(e){if(9===e.keyCode){if(e.shiftKey){let e=document.querySelectorAll(".tour-option-list a");e[e.length-1].focus()}else document.querySelector(".btnconfirmbed button").focus();e.preventDefault(),e.stopPropagation()}}),e.addEventListener("keyup",function(t){13!==t.keyCode&&32!==t.keyCode||n(e)})}),t&&t.forEach(function(e){e.addEventListener("click",function(){n(e)}),e.addEventListener("keydown",function(e){if(9===e.keyCode){if(e.shiftKey){let e=document.querySelectorAll(".tour-option-list a");e[e.length-1].focus()}else document.querySelector(".btnconfirmbed button").focus();e.preventDefault(),e.stopPropagation()}}),e.addEventListener("keyup",function(t){13!==t.keyCode&&32!==t.keyCode||n(e)})});var o=document.querySelector(".btnconfirmbed");o&&o.addEventListener("click",function(){var e=document.getElementById("main-content");scrollTo(document.body,e.offsetTop),c(3),y("calendar")})}(),function(){if(!document.getElementById("isScheduleFromLink")&&document.querySelector(".timeconfirmbtn")){var e=document.querySelector(".timeconfirmbtn");e.addEventListener("click",function(){var e="";e="0"===document.getElementById("tourType").value?"Guided Tour":"1"===document.getElementById("tourType").value?"Self-Guided Tour":"Live Video Tour",document.getElementById("txtBedroom")&&""!==document.getElementById("txtBedroom").value&&(""!==e&&(e+=", "),e=e+document.getElementById("txtBedroom").value+" Bed(s)"),""!==e&&(e+=", ");var t=e+document.querySelector(".timeconfirmbtn").innerHTML.replace("Confirm ","");ysi.scheduleTourData.useSGTBedSelect?document.querySelector(".confirmtimediv").innerHTML=t:document.querySelector(".confirmtimediv").innerHTML=t+", Unit(s): "+n.join(", "),document.querySelector(".scheduletourcofirmbutton").innerHTML="Review & Submit",document.getElementById("TourType").value=document.getElementById("tourType").value,"0"===document.getElementById("TourType").value?document.getElementById("IdVerification").value=document.getElementById("enableidv-gt").value:"1"===document.getElementById("TourType").value?document.getElementById("IdVerification").value=document.getElementById("enableidv").value:document.getElementById("IdVerification").value=document.getElementById("enableidv-lvt").value;var o=document.getElementById("main-content");scrollTo(document.body,o.offsetTop),c(4),y("confirmation"),ysi.adwords&&ysi.adwords.setHiddenFields()})}}(),function(){var e=0;document.querySelectorAll(".info-block").forEach(function(t){var n=t.innerHTML.trim();if(n.length>65){var o=n.substr(0,65),r=n.substr(65,n.length-65),l=o+'<span class="dots">...</span><span id="more-info-'+e+'"  class="more">'+r+'</span><br><button aria-describedby="heading-1" class="btn-sm btn btn-link btn-read-more px-0"><span class="btn-read-more-text">'+ysi.utils.translateText("Read more")+'<span class="sr-only">'+ysi.utils.translateText("about "+t.previousElementSibling.innerText)+"</span></span></button >";t.innerHTML=l}e++});var t=document.querySelectorAll(".more"),n=document.querySelectorAll(".btn-read-more");[].forEach.call(t,function(e){e.setAttribute("hidden",!0),e.style.display="none"}),[].forEach.call(n,function(e){e.removeAttribute("hidden"),e.setAttribute("aria-expanded",!1),e.addEventListener("click",function(){fullTextWrapper=this.parentElement.querySelector(".more"),toggleButtonText=this.querySelector(".btn-read-more-text"),dots=this.parentElement.querySelector(".dots"),fullTextWrapper.hasAttribute("hidden")?(toggleButtonText.innerHTML=ysi.utils.translateText("Read less")+'<span class="sr-only">'+ysi.utils.translateText("about "+e.parentElement.previousElementSibling.innerText)+"</span>",dots.innerText="",fullTextWrapper.removeAttribute("hidden"),fullTextWrapper.style.display="inline",e.setAttribute("aria-expanded",!0)):(toggleButtonText.innerHTML=ysi.utils.translateText("Read more")+'<span class="sr-only">'+ysi.utils.translateText("about "+e.parentElement.previousElementSibling.innerText)+"</span>",dots.innerText="...",fullTextWrapper.setAttribute("hidden",!0),fullTextWrapper.style.display="none",e.setAttribute("aria-expanded",!1))})})}(),function(){var t=0,n=0;document.querySelectorAll(".tour-popup-floorplans").forEach(function(e){e.addEventListener("click",function(){document.querySelectorAll(".tour-popup-floorplans").forEach(function(e){e.classList.remove("selected-floorplan")}),document.querySelectorAll(".tour-popup-right-panel").forEach(function(e){e.classList.add("d-none")});var t,n,o=document.getElementById("dropdownMenuButton").textContent,r=e.getAttribute("data-order");"360 Tour"===o?(t=document.getElementById("tour-360-fp-"+r),n=document.getElementById("tour-360-content-"+r)):(t=document.getElementById("tour-video-fp-"+r),n=document.getElementById("tour-video-content-"+r)),null!==t&&null!==n&&(t.classList.remove("d-none"),n.classList.remove("d-none")),e.classList.add("selected-floorplan"),document.querySelectorAll(".floorplan-dropdown-display").forEach(function(e){e.classList.add("d-none")}),document.getElementById("floorplan-dropdown-display-"+r).classList.remove("d-none"),document.getElementById("floorplan-dropdown-list").classList.remove("active-fp-list")}),e.classList.contains("has-360-tour-code")&&t++,e.classList.contains("has-video")&&n++}),document.querySelectorAll("#tour-popup-dropdown a.dropdown-item").forEach(function(e){e.addEventListener("click",function(){var t=e.textContent;document.getElementById("dropdownMenuButton").innerHTML=t;var n=!1;return document.querySelectorAll(".tour-popup-floorplans").forEach(function(e){e.classList.add("d-none"),"360 Tour"===t?e.classList.contains("has-360-tour-code")&&(e.classList.remove("d-none"),n||(document.querySelector(".tour-popup-floorplans.has-360-tour-code").click(),n=!0)):e.classList.contains("has-video")&&(e.classList.remove("d-none"),n||(document.querySelector(".tour-popup-floorplans.has-video").click(),n=!0))}),!1})}),(n||t)&&(t&&!n?(document.querySelector("#tour-popup-dropdown #dropdown-360tour").click(),document.querySelector("#tour-popup-dropdown #dropdown-video").remove()):n&&!t?(document.querySelector("#tour-popup-dropdown #dropdown-video").click(),document.querySelector("#tour-popup-dropdown #dropdown-360tour").remove()):document.querySelector("#tour-popup-dropdown #dropdown-360tour").click());const o=document.getElementById("360Tour-close-header"),r=document.getElementById("360Tour-close-footer");var l,a;if(document.addEventListener("keydown",function(e){("Tab"===e.key||9===e.keyCode)&&(e.shiftKey?document.activeElement===o&&(r.focus(),e.preventDefault()):document.activeElement===r&&(o.focus(),e.preventDefault()))}),e)for(e.addEventListener("shown.bs.modal",function(e){o.focus()},!1),a=document.getElementsByTagName("iframe"),l=0;l<a.length;++l){let e=a[l].hasAttribute("title");e||a[l].setAttribute("title","Tour Video")}}(),r(),function(){var e=document.getElementsByClassName("scheduletourcofirmbutton")[0],t=document.getElementById("st-confirm-submit"),o=e.cloneNode(!0);o.innerText="Review & Submit",o.addEventListener("click",()=>{var e=document.getElementById("scheduletour-myContactForm"),t=(e.querySelector('input[name="prefix"]'),e.querySelector('input[type="email"]')),o=e.querySelector('input[type="tel"]'),r=e.querySelector("input[name=txtDesiredMoveinDate]"),l=(e.querySelector("input[name=FirstName]"),e.querySelector("input[name=LastName]"),e.querySelector("textarea[id$=message]")),a=(e.querySelector(".submit-button"),e.querySelectorAll(".needs-validation .required"));[].forEach.call(a,function(e){""==e.value?(e.setCustomValidity("This value is required."),e.classList.add("is-invalid"),e.setAttribute("aria-describedby",e.dataset.ariaDescribedby)):e!=r&&(e.setCustomValidity(""),e.classList.remove("is-invalid"),e.classList.add("is-valid"),e.removeAttribute("aria-describedby"))});var c=t.checkValidity(),d=o.checkValidity();if(c?t.setCustomValidity(""):t.setCustomValidity("Please enter a valid email."),d?o.setCustomValidity(""):o.setCustomValidity("Please enter a valid phone number."),l){let e=l.checkValidity();e?l.setCustomValidity(""):l.setCustomValidity("Please enter a mesage.")}r&&(r.classList.contains("is-invalid")?r.setCustomValidity("Please enter valid date."):r.setCustomValidity(""));var i=e.querySelector("input:invalid,textarea:invalid");if(i&&i.focus(),i)return!1;if(!e.checkValidity())return event.preventDefault(),event.stopPropagation(),e.classList.add("was-validated"),!1;var s=document.getElementById("st-confirm-tourtype"),u=document.getElementById("st-confirm-tourdate"),m=document.getElementById("st-confirm-firstname"),p=document.getElementById("st-confirm-lastname"),v=document.getElementById("st-confirm-email"),g=document.getElementById("st-confirm-mobile"),f=document.getElementById("st-confirm-message"),E=document.getElementById("st-confirm-movein"),h="";h="0"===document.getElementById("tourType").value?"Guided Tour - ":"1"===document.getElementById("tourType").value?"Self-Guided Tour - ":"Live Video Tour - ",document.getElementById("txtBedroom")&&""!==document.getElementById("txtBedroom").value&&(h=h+document.getElementById("txtBedroom").value+" Bed(s)"),ysi.scheduleTourData.useSGTBedSelect||"1"!==document.getElementById("tourType").value||(h=h+"Unit(s): "+n.join(", ")),s.innerText=h,u.innerText=document.querySelector(".timeconfirmbtn").innerHTML.replace("Confirm ",""),m.innerText=document.getElementById("scheduletour-firstname").value,p.innerText=document.getElementById("scheduletour-lastname").value,v.innerText=document.getElementById("scheduletour-email").value,g.innerText=document.getElementById("scheduletour-phonenumber").value,f.innerText=document.getElementById("scheduletour-message").value,E&&(document.getElementById("txtDesiredMoveinDate")&&""!==document.getElementById("txtDesiredMoveinDate").value?E.innerText=document.getElementById("txtDesiredMoveinDate").value:E.innerText=""),"1"===document.getElementById("tourType").value&&"True"===document.getElementById("enableidv").value?(document.getElementById("IDVinfocontent").classList.remove("d-none"),document.getElementById("st-confirm-submit").innerHTML="Continue to Online ID Verification"):"0"===document.getElementById("tourType").value&&"True"===document.getElementById("enableidv-gt").value?(document.getElementById("IDVinfocontent").classList.remove("d-none"),document.getElementById("st-confirm-submit").innerHTML="Continue to Online ID Verification"):"2"===document.getElementById("tourType").value&&"True"===document.getElementById("enableidv-lvt").value?(document.getElementById("IDVinfocontent").classList.remove("d-none"),document.getElementById("st-confirm-submit").innerHTML="Continue to Online ID Verification"):(document.getElementById("IDVinfocontent")&&document.getElementById("IDVinfocontent").classList.add("d-none"),document.getElementById("st-confirm-submit").innerHTML="Confirm & Book Your Tour"),y("submit")}),e.hidden=!0,e.parentNode.insertBefore(o,e);var r=document.getElementById("st-confirm-tourtype-edit"),l=document.getElementById("st-confirm-tourdate-edit"),a=document.getElementById("st-confirm-tourinfo-edit");r.addEventListener("click",()=>{c(1),y("select")}),l.addEventListener("click",()=>{c(3),y("calendar")}),a.addEventListener("click",()=>{c(4),y("confirmation")}),t.addEventListener("click",()=>{t.innerHTML="<i class='fas fa-spinner fa-spin'></i> "+ysi.utils.translateText("Processing Request..."),t.disabled=!0,r.disabled=!0,l.disabled=!0,a.disabled=!0,e.click()})}();var a=ysi.scheduleTourData.preselectedTourType,d=ysi.scheduleTourData.preselectedBed,i=ysi.scheduleTourData.preselectedFloorplan;if(ysi.scheduleTourData.preselectedSqft,ysi.scheduleTourData.preselectedRentMin,ysi.scheduleTourData.preselectedRentMax,""!==a&&""!==d&&""!==i)if("GT"===a.toUpperCase()){var s=document.getElementById("guided-tour-option");if(s){s.click();let e=document.querySelector('.gt-bedselect[data-value="'+d+'"]');e&&e.click()}else{c(3);var u=document.getElementById("BedroomsControlSelect");u&&(u.value=d),(v=document.getElementById("tourType"))&&(v.value=0),y("calendar")}}else if("SGT"===a.toUpperCase())if(ysi.scheduleTourData.useSGTBedSelect){let e=document.getElementById("self-guided-tour-option");if(e){e.click();let t=document.querySelector('.sgt-bedselect[data-value="'+d+'"]');t&&t.click()}}else{var p=document.getElementById("bedsSelection-"+d),v=document.getElementById("tourType");p.click(),v.value=1,c(2),y("floorplan")}else{document.getElementById("live-video-tour-option").click();let e=document.querySelector('.gt-bedselect[data-value="'+d+'"]');e&&e.click()}}()};